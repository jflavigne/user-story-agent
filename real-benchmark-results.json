{
  "timestamp": "2026-01-31T22:04:05.542Z",
  "stories": [
    {
      "id": "story-1",
      "pass1cScore": 4,
      "recommendation": "approve",
      "needsManualReview": false,
      "content": "# Untitled\n\nAs a creative professional browsing portfolios on mobile\nI want to apply filters to narrow down the portfolio projects displayed\nSo that I can quickly find projects that match my creative interests and inspiration needs\n\n## User-Visible Behavior\n\n- [UVB-001] User sees a prominent filter button or icon in the portfolio browser interface, clearly labeled for easy discovery on mobile devices\n- [UVB-002] When tapped, the filter interface opens as a mobile-optimized overlay or slide-up panel with touch-friendly filter controls\n- [UVB-003] Filter options include interactive elements like checkboxes for categories, radio buttons for exclusive selections, and dropdown selects for multi-option fields\n- [UVB-004] Selected filter options show clear visual feedback with selected states, and applied filters display as removable tags or chips in the main interface\n- [UVB-005] Filter interface includes primary action buttons (Apply/Done) and secondary actions (Clear All/Reset) with appropriate touch target sizes for mobile interaction\n- [UVB-006] On narrow viewports (mobile), filter interface opens as full-screen overlay or slide-up panel that maximizes touch interaction space\n- [UVB-007] On wider viewports (tablet/desktop), filter interface appears as sidebar panel or dropdown overlay positioned near the filter trigger\n- [UVB-008] Filter controls stack vertically on narrow screens and arrange in multiple columns on wider screens for efficient space usage\n- [UVB-009] Applied filter tags appear as horizontally scrollable chips on mobile and wrap to multiple lines on wider screens\n\n## Acceptance Criteria (Outcome)\n\n- [AC-OUT-001] When I access the portfolio browser on mobile, I can see available filter options appropriate for creative project discovery\n- [AC-OUT-002] When I select filter criteria, the displayed projects update to show only those matching my selections\n- [AC-OUT-003] I can apply multiple filters simultaneously to narrow my search for specific types of creative work\n- [AC-OUT-004] I can easily clear or modify filters to explore different creative directions without starting over\n- [AC-OUT-005] When I tap the filter button, the filter interface opens with all interactive elements properly sized for touch interaction and clearly labeled\n- [AC-OUT-006] When I select filter options using checkboxes, radio buttons, or dropdowns, each selection provides immediate visual feedback showing the selected state\n- [AC-OUT-007] When I tap Apply or Done, the filter interface closes and selected filters appear as removable tags with clear tap targets for individual removal\n- [AC-OUT-008] When I tap Clear All or individual filter removal buttons, the action provides immediate visual feedback and updates the displayed projects accordingly\n- [AC-OUT-009] When filter fields are required for search functionality, they are clearly marked with visual indicators and validation feedback appears inline when empty\n- [AC-OUT-010] When invalid filter combinations are selected (e.g., conflicting categories), clear error messages explain the constraint and guide resolution\n- [AC-OUT-011] When filter validation fails, the Apply/Done button remains disabled and error states are visually distinct from valid selections\n- [AC-OUT-012] When all filter constraints are met, positive visual feedback (such as enabled buttons or success indicators) confirms the filter configuration is valid\n- [AC-OUT-013] When I navigate the filter interface using keyboard, I can reach all interactive elements (checkboxes, dropdowns, buttons) in a logical tab order\n- [AC-OUT-014] When I use a screen reader, filter options are clearly announced with their current state (checked/unchecked, selected/unselected) and purpose\n- [AC-OUT-015] When filter results update or validation errors occur, status changes are announced to screen readers so I know the interface has responded to my actions\n- [AC-OUT-016] When I focus on interactive elements in the filter interface, visible focus indicators show which element is currently selected for activation\n- [AC-OUT-017] When using the filter interface, all text has sufficient contrast for readability and error states are indicated by more than color alone (using text, icons, or other visual cues)\n- [AC-OUT-018] When I close the filter interface using the Escape key or screen reader navigation, focus returns to the element that opened the filter panel\n- [AC-OUT-020] When I first access the portfolio browser, I can see which languages are available through clear language indicators (flags, language names, or codes) and understand how to change the interface language\n- [AC-OUT-021] When I select a different language, the filter interface immediately updates to display filter labels, categories, and button text in the selected language without losing my current filter selections\n- [AC-OUT-022] When using RTL languages (Arabic, Hebrew), I see the filter interface properly mirrored with controls aligned to the right side and the filter panel sliding from the appropriate direction for natural RTL interaction\n- [AC-OUT-023] When I enter search terms or filter values with accented characters, special symbols, or non-Latin scripts, the text displays correctly and my searches work properly to find matching portfolio projects\n- [AC-OUT-024] When some filter categories or project descriptions are not yet translated to my selected language, I can clearly see which content is shown in the original language and which is translated\n- [AC-OUT-025] When filter validation errors occur, I see error messages in my selected language, and if translations are not available, I see them in a clear fallback language with visual indication of the language difference\n- [AC-OUT-026] When using RTL languages, I can interact with filter checkboxes, dropdowns, and buttons naturally with the expected right-to-left interaction patterns and properly positioned visual elements\n- [AC-OUT-027] When my browser or device language preference changes, the portfolio browser detects this change and offers to switch the interface language while maintaining my current filter state and browsing session\n- [AC-OUT-028] When I view project dates in the filter interface, they are displayed in my regional format (MM/DD/YYYY, DD/MM/YYYY, or YYYY-MM-DD) so I can quickly understand when projects were created or completed\n- [AC-OUT-029] When I filter projects by date ranges or time periods, I can enter dates in my familiar regional format and see date picker interfaces that match my expected date entry patterns\n- [AC-OUT-030] When I view project durations or time estimates, they are displayed using time formats I expect (12-hour with AM/PM or 24-hour format) based on my regional preferences\n- [AC-OUT-031] When I see project budget ranges or pricing filters, currency amounts are displayed with correct symbols positioned appropriately for my region (before or after the amount) and formatted with expected decimal separators\n- [AC-OUT-032] When I enter budget ranges or price filters, I can input currency amounts using my regional decimal separator (period or comma) and thousands separator format without causing validation errors\n- [AC-OUT-033] When I view project metrics like view counts, likes, or engagement numbers, they are formatted with appropriate thousands separators (commas, periods, or spaces) that match my regional number formatting expectations\n- [AC-OUT-034] When I filter by project dimensions or file sizes, measurement units are displayed in the system I expect (metric vs imperial) and I can understand the scale and size of creative assets\n- [AC-OUT-035] When viewing projects from different regions, creator location information is formatted appropriately for each country's address conventions, helping me understand the geographic context of the creative work\n- [AC-OUT-036] When filter interfaces display relative time information (like 'updated 2 days ago' or 'created last month'), these expressions are localized to my language and cultural time reference patterns\n- [AC-OUT-037] When I view portfolio projects from different regions, the color choices used in project thumbnails and filter interface elements are culturally appropriate and don't conflict with my cultural associations or expectations\n- [AC-OUT-038] When I see status indicators in the filter interface (such as checkmarks for selected filters or warning icons for validation), these icons have meanings that align with my cultural expectations and don't cause confusion or offense\n- [AC-OUT-039] When I browse portfolio projects, the imagery and visual content represents diverse creative professionals in a respectful way that doesn't rely on stereotypes or make assumptions about cultural backgrounds based on appearance\n- [AC-OUT-040] When I view creator names and professional titles in portfolio listings, they are displayed according to cultural naming conventions appropriate for each creator's background (given name order, honorifics, professional designations)\n- [AC-OUT-041] When I filter projects by categories or creative disciplines, the category names and descriptions don't reflect cultural biases about what types of creative work are valued or appropriate for different cultural backgrounds\n- [AC-OUT-042] When I encounter cultural or religious symbols in portfolio project imagery or interface elements, they are used respectfully and appropriately without misappropriation or misrepresentation of their cultural significance\n- [AC-OUT-043] When I use workflow features like saving projects or sharing portfolios, the interaction patterns match my cultural expectations for social sharing and professional networking behaviors\n- [AC-OUT-044] When I view project completion dates or creative process timelines, they account for different cultural holidays, work week patterns, and time-off periods that affect when creative work is typically produced or published\n- [AC-OUT-DEP-1] Enables story-2 (dependent story).\n\n## Acceptance Criteria (System)\n\n- [AC-SYS-001] Filter validation occurs in real-time as users interact with filter controls, providing immediate feedback without requiring submission\n- [AC-SYS-002] Invalid filter states prevent form submission and trigger error state indicators on affected filter controls with accessible error announcements\n- [AC-SYS-003] Filter validation rules are enforced on both client-side for immediate feedback and server-side for data integrity when applying filters to portfolio queries\n- [AC-SYS-004] Filter form controls include proper ARIA labels, roles, and states to communicate purpose and current state to assistive technologies\n- [AC-SYS-005] Filter validation errors and result updates trigger live region announcements (aria-live) to inform screen reader users of state changes\n- [AC-SYS-006] Filter interface maintains keyboard navigation support with proper focus management, trapping focus within modal overlays and providing ESC key exit functionality\n- [AC-SYS-007] All interactive filter elements meet minimum touch target sizes and include adequate spacing to prevent accidental activation on mobile devices\n- [AC-SYS-008] Filter interface displays immediate loading state feedback when applying filters, showing loading indicators on filter actions and portfolio results area\n- [AC-SYS-009] Filter application response time provides immediate visual feedback within 100ms of user action, with full portfolio results displayed within 2 seconds for typical filter queries\n- [AC-SYS-010] Filter operations that exceed 2 seconds display progress indicators with option to cancel, and operations exceeding 10 seconds provide timeout handling with retry mechanism\n- [AC-SYS-011] Portfolio browser shows skeleton placeholders or cached content during filter loading to maintain layout stability and communicate loading progress\n- [AC-SYS-012] Filter interface validates that the user is authenticated before allowing filter modification actions, redirecting to secure login if session has expired\n- [AC-SYS-013] Filter input values are validated and sanitized to prevent XSS attacks and SQL injection through filter parameters sent to backend services\n- [AC-SYS-014] Filter API endpoints implement rate limiting to prevent abuse and DDoS attacks through rapid filter requests from individual users or IP addresses\n- [AC-SYS-015] Filter data transmission uses HTTPS encryption and filter parameters are not logged in plain text to protect user search behavior privacy\n- [AC-SYS-016] Filter interface adapts touch target sizes and spacing based on viewport size: minimum 44px targets on narrow screens, smaller targets allowed on wider screens with pointer devices\n- [AC-SYS-017] Filter panel opening behavior adapts to viewport: modal overlay with focus trap on narrow screens, positioned dropdown with click-outside-to-close on wider screens\n- [AC-SYS-018] Filter layout reflows from vertical stacking on narrow viewports to multi-column arrangement on wider screens without affecting filter state or validation\n- [AC-SYS-019] Filter interface supports both touch gestures (tap, scroll) on mobile devices and mouse interactions (click, hover, wheel scroll) on desktop devices\n\n## Implementation Notes"
    },
    {
      "id": "story-2",
      "pass1cScore": 3,
      "pass1cAfterRewriteScore": 3,
      "recommendation": "rewrite",
      "needsManualReview": true,
      "content": "As a creative professional,\nI want to quickly clear all applied filters from the project portfolio browser,\nSo that I can easily return to viewing the complete portfolio without manually removing each filter.\n\n## User-Visible Behavior\n\nI see a project portfolio interface with comprehensive filtering controls. When filters are active, a prominent \"Clear All Filters\" control appears with visual feedback on interaction. The portfolio displays responsively across devices with adaptive layouts and touch-optimized controls.\n\n## Outcome Acceptance Criteria\n\n### Core Functionality\n- When I click \"Clear All Filters,\" all applied filters are removed and the full portfolio displays\n- The clear filters control is visible only when filters are applied and hidden/disabled otherwise\n- I receive immediate visual feedback that filters have been cleared and can see the total number of portfolio items\n- The control responds to both mouse clicks and keyboard activation (Enter/Space)\n\n### Input Validation & Feedback\n- When I enter invalid filter criteria (blank required fields, invalid date ranges, malformed inputs), clear error messages appear inline explaining how to correct the input\n- Required fields are clearly marked and filter submission is disabled until valid criteria are provided\n- Filter fields show format requirements through placeholder text or helper examples\n- The system avoids overloading with too many requests during validation\n\n### Accessibility & Navigation\n- When using keyboard navigation, I can reach all controls in logical order with clear focus indicators\n- Assistive technology announces control purposes, filter actions, and validation errors without relying on color alone\n- All interactive elements meet minimum contrast requirements and remain readable at 200% zoom\n- Complex controls (dropdowns, date pickers) support keyboard navigation and clear interaction patterns\n- Required fields are properly marked for screen readers\n\n### Internationalization & Localization\n- When I select a language, the interface switches immediately with visual confirmation and remembers my preference\n- RTL languages mirror the interface appropriately while maintaining intuitive interactions\n- Project dates, currencies, and numbers display in my regional format\n- Interface accommodates diverse naming conventions and cultural contexts without imposing Western assumptions\n\n### Responsive Experience\n- On mobile: Single-column portfolio grid with collapsible filter drawer\n- On tablet: 2-3 column grid with expandable sidebar or top filter bar\n- On desktop: Multi-column grid (3-6 columns) with persistent filter controls\n- Touch targets meet minimum size requirements with appropriate virtual keyboard handling\n- Layout automatically adjusts to different screen sizes\n- Images load at appropriate quality for each device\n\n## System Acceptance Criteria\n\n### Validation & Error Handling\n- Filter validation occurs in real-time with debounced input to prevent excessive API calls\n- Date range validation ensures start date precedes end date with appropriate error persistence\n- ARIA live regions announce validation errors and filter updates with proper timing\n- Required fields marked with aria-required and errors associated via aria-describedby\n\n### Performance & Loading\n- Filter operations show immediate UI feedback with loading indicators\n- Skeleton content maintains layout stability during result updates\n- System handles slow networks with timeout handling and retry mechanisms\n- Response times meet acceptable thresholds for filter operations\n\n### Security & Authentication\n- Filter parameters sanitized on both client and server to prevent injection attacks\n- Authentication state validated before applying filters\n- Rate limiting implemented on portfolio API endpoints\n- All data transmission occurs over HTTPS with secure session management\n\n### Responsive Implementation\n- CSS Grid/Flexbox implements responsive breakpoints for automatic column adjustment\n- FilterPanel component manages collapsed/expanded states across devices\n- Touch event handling differentiates between click and touch with immediate feedback\n- Virtual keyboard detection adjusts viewport calculations\n\n### Analytics & Insights\n- User interaction patterns tracked including filter sequences and search queries\n- Click-through behavior measured from portfolio browsing to project details\n- Time-on-task metrics captured for filter discovery and application workflows\n- Cross-session behavior patterns analyzed for optimization insights\n\n## Implementation Notes\n\n### State Management\n- C-STATE-FILTER-STATE persists across device orientation changes and breakpoint transitions\n- Component state maintains validation status until filters are cleared or corrected\n- User preferences stored securely for cross-session persistence\n\n### Image Optimization\n- Responsive image loading with srcset and sizes attributes for different viewport widths and pixel densities\n\n### Keyboard & Focus Management\n- Focus moves logically through controls and returns appropriately after actions\n- Focus indicators meet accessibility requirements with sufficient contrast\n\n## UI Mapping\n\nFilter controls adapt layout based on viewport:\n- Mobile: Collapsible FilterSheet with touch-optimized controls\n- Tablet: Expandable sidebar or horizontal FilterBar\n- Desktop: Persistent sidebar or toolbar with mouse hover states\n\n## UI Mapping\n\n- \"Clear All Filters\" → COMP-CLEAR-ALL-LINK\n- \"filter controls\" → COMP-FILTERGROUP\n- \"FilterSheet\" → COMP-FILTERSHEET\n- \"FilterBar\" → COMP-FILTERBAR\n- \"project portfolio\" → COMP-PROJECT-GRID\n- \"loading indicators\" → COMP-SPINNERLOADING\n\n## Contract Dependencies\n\n- C-STATE-FILTER-STATE\n- C-STATE-PROJECT-GRID-STATE\n- C-STATE-UI-STATE\n- E-FILTERS-CLEARED\n- E-PROJECTS-FILTERED\n- E-FILTERS-RECALCULATED\n- EVENT-FILTER-VALIDATION\n\n## Ownership\n\n**Consumes State**: C-STATE-FILTER-STATE, C-STATE-PROJECT-GRID-STATE, C-STATE-UI-STATE\n**Emits Events**: E-FILTERS-CLEARED, E-PROJECTS-FILTERED\n**Listens To**: E-FILTERS-RECALCULATED, EVENT-FILTER-VALIDATION\n\n\n## Related Stories\n\n**Prerequisites**:\n- story-1: Requires filter functionality to be implemented first before being able to clear filters"
    }
  ],
  "metrics": {
    "averageScore": 3.5,
    "scoresDistribution": {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 1,
      "4": 1,
      "5": 0
    },
    "storiesAbove4Count": 1,
    "storiesAbove4Pct": 50,
    "rewriteCount": 1,
    "rewritePct": 50,
    "manualReviewCount": 1,
    "manualReviewPct": 50
  },
  "metadata": {
    "passesCompleted": [
      "Pass 0 (discovery)",
      "Pass 1 (generation with refinement)",
      "Pass 2 (interconnection)",
      "Pass 2b (global consistency)"
    ],
    "refinementRounds": 2,
    "fixesApplied": 1,
    "fixesFlaggedForReview": 0,
    "fixesRejected": 0
  },
  "systemContext": {
    "componentGraph": {
      "components": {
        "COMP-FILTERSHEET": {
          "id": "COMP-FILTERSHEET",
          "productName": "FilterSheet",
          "description": "Document 1: 'A mobile-exclusive bottom sheet (sliding from the bottom) for task-based filtering'"
        },
        "COMP-FILTERBAR": {
          "id": "COMP-FILTERBAR",
          "productName": "FilterBar",
          "description": "Document 2: 'Desktop-exclusive horizontal assembly used to refine content grids'"
        },
        "COMP-FILTERGROUP": {
          "id": "COMP-FILTERGROUP",
          "productName": "FilterGroup",
          "description": "Document 1: 'It nests FilterGroup molecules within an accordion structure'"
        },
        "COMP-FILTERITEM": {
          "id": "COMP-FILTERITEM",
          "productName": "FilterItem",
          "description": "Document 3: 'FilterItem: Single selectable filter with active/inactive states'"
        },
        "COMP-SPINNERLOADING": {
          "id": "COMP-SPINNERLOADING",
          "productName": "SpinnerLoading",
          "description": "Document 3: 'SpinnerLoading: Loading indicator during filter updates'"
        },
        "COMP-HEADER": {
          "id": "COMP-HEADER",
          "productName": "Header",
          "description": "Document 1: Shows header with title 'Filters' and clear all link"
        },
        "COMP-CLEAR-ALL-LINK": {
          "id": "COMP-CLEAR-ALL-LINK",
          "productName": "Clear All Link",
          "description": "Document 1: 'Clear all link (top right)' and Document 2: 'Clear all link on far right'"
        },
        "COMP-CLOSE-BUTTON": {
          "id": "COMP-CLOSE-BUTTON",
          "productName": "Close Button",
          "description": ""
        },
        "COMP-ACCORDION": {
          "id": "COMP-ACCORDION",
          "productName": "Accordion",
          "description": "Document 1: 'FilterGroup molecules within an accordion structure'"
        },
        "COMP-TOGGLE": {
          "id": "COMP-TOGGLE",
          "productName": "Toggle",
          "description": ""
        },
        "COMP-DESELECT-BUTTON": {
          "id": "COMP-DESELECT-BUTTON",
          "productName": "Deselect Button",
          "description": ""
        },
        "COMP-PROJECT-GRID": {
          "id": "COMP-PROJECT-GRID",
          "productName": "Project Grid",
          "description": "Document 1: 'Project grid updates in real-time in background'"
        }
      },
      "compositionEdges": [],
      "coordinationEdges": [],
      "dataFlows": []
    },
    "sharedContracts": {
      "stateModels": [
        {
          "id": "C-STATE-FILTER-STATE",
          "name": "Filter State",
          "description": "Document 3: 'selectedFilters: Map of category to selected filter IDs'",
          "owner": "",
          "consumers": []
        },
        {
          "id": "C-STATE-PROJECT-GRID-STATE",
          "name": "Project Grid State",
          "description": "",
          "owner": "",
          "consumers": []
        },
        {
          "id": "C-STATE-UI-STATE",
          "name": "UI State",
          "description": "",
          "owner": "",
          "consumers": []
        }
      ],
      "eventRegistry": [
        {
          "id": "E-FILTER-SELECTED",
          "name": "filter-selected",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-FILTER-DESELECTED",
          "name": "filter-deselected",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-FILTERS-CLEARED",
          "name": "filters-cleared",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-GROUP-TOGGLED",
          "name": "group-toggled",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-SHEET-OPENED",
          "name": "sheet-opened",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-SHEET-CLOSED",
          "name": "sheet-closed",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-FILTERS-RECALCULATED",
          "name": "filters-recalculated",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-PROJECTS-FILTERED",
          "name": "projects-filtered",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "E-ZERO-RESULTS-HIDDEN",
          "name": "zero-results-hidden",
          "payload": {},
          "emitter": "",
          "listeners": []
        },
        {
          "id": "EVENT-FILTER-VALIDATION",
          "name": "Filter Validation Event",
          "payload": {},
          "emitter": "",
          "listeners": []
        }
      ],
      "standardStates": [
        {
          "type": "loading",
          "description": "Data or action in progress"
        },
        {
          "type": "error",
          "description": "Error state"
        },
        {
          "type": "empty",
          "description": "No data"
        },
        {
          "type": "success",
          "description": "Data loaded or action completed"
        }
      ],
      "dataFlows": []
    },
    "componentRoles": [],
    "productVocabulary": {
      "selectedFilters": "Filter State",
      "availableFilters": "Filter State",
      "filterCounts": "Filter State",
      "isLoading": "Filter State",
      "filteredProjects": "Project Grid State",
      "totalCount": "Project Grid State",
      "displayProjects": "Project Grid State",
      "isSheetOpen": "UI State",
      "expandedGroups": "UI State",
      "scrollPosition": "UI State",
      "bottom sheet": "FilterSheet",
      "horizontal assembly": "FilterBar",
      "filter group columns": "FilterGroup",
      "spinner indicator": "SpinnerLoading",
      "loading indicator": "SpinnerLoading",
      "clear all": "Clear All Link",
      "X icon": "Close Button",
      "deselect button": "Deselect Button",
      "project grid": "Project Grid",
      "results grid": "Project Grid",
      "content grid": "Project Grid"
    },
    "timestamp": "2026-01-31T21:45:46.054Z",
    "referenceDocuments": [
      "# FilterSheet - Mobile Filtering Interface\n\n## Component Type\nOrganism (ORG) - Mobile-exclusive bottom sheet\n\n## Description\nA mobile-exclusive bottom sheet (sliding from the bottom) for task-based filtering. It nests FilterGroup molecules within an accordion structure and provides a header for a global \"Clear all\" action.\n\n## Visual Elements\n\n### Header\n- Title: \"Filters\"\n- \"Clear all\" link (top right)\n- Close button (X icon, top right)\n\n### Filter Groups (Accordion Structure)\n\n**Expertises Group**\n- Group header: \"Expertises\" with collapse/expand toggle (— or +)\n- Filter items:\n  - Brand & Experience Strategy\n  - Campaign & content design (with X icon when selected)\n  - Digital Product & Platforms\n  - AI & Data & Innovation\n  - Architectural Design\n\n**Creative Lenses Group**\n- Group header: \"Creative Lenses\" with collapse/expand toggle\n- Filter items:\n  - Non-Profit\n  - Out-of-the-Box Thinking\n  - Social Impact\n  - Storytelling\n\n## States\n\n### Default State\n- All groups collapsed or expanded\n- No filters selected\n- All filter items visible\n\n### Loading State\n- Spinner indicator shown\n- Filter items grayed out during update\n- Background content visible through sheet gap\n\n### Active State\n- Selected filters show X icon (deselect button)\n- Selected items visually highlighted\n- Zero-result filters automatically hidden\n- Project grid updates in real-time in background\n\n## Behavior\n\n### Real-Time Filtering\n- Selection immediately updates project grid\n- Filter list dynamically hides items that would yield zero results\n- Both filter list and project listing update simultaneously\n\n### Interdependent Filters\n- Filters affect each other's availability\n- As user selects option, both lists update in real-time\n- Zero-result paths automatically hidden\n\n### Accordion Interaction\n- Tap group header to expand/collapse\n- Multiple groups can be open simultaneously\n- Collapse icon changes: — (expanded) ↔ + (collapsed)\n\n### Clear All\n- Resets all selected filters\n- Shows all available filter options again\n- Updates project grid to show all items\n\n## Technical Notes\n- Bottom sheet slides up from bottom of screen\n- Leave transparent gap to see background content updating\n- Smooth transitions between states\n- Maintains scroll position within groups\n",
      "# FilterBar - Desktop Filtering Interface\n\n## Component Type\nOrganism (ORG) - Desktop-exclusive horizontal assembly\n\n## Description\nDesktop-exclusive horizontal assembly used to refine content grids. It orchestrates FilterGroup columns and features a global \"Clear all\" action.\n\n## Visual Elements\n\n### Layout\n- Horizontal layout spanning full width\n- Multiple filter group columns side-by-side\n- \"Clear all\" link on far right\n- Horizontal divider line separating from content below\n\n### Filter Groups (Columns)\n\n**Expertises Column**\n- Header: \"Expertises\"\n- Filter items:\n  - Brand & Experience Strategy (with X icon - selected)\n  - Campaign & content design\n  - Digital Product & Platforms\n\n**Creative Lenses Column**\n- Header: \"Creative Lenses\"\n- Filter items:\n  - AI & Data & Innovation (with X icon - selected)\n  - Architectural Design\n  - Non-Profit\n  - Out-of-the-Box Thinking\n  - Social Impact\n\n## States\n\n### Default State\n- All columns visible\n- No filters selected\n- All filter items available\n\n### Active State\n- Selected filters show X icon (deselect button)\n- Selected items visually highlighted\n- Zero-result filters automatically hidden\n\n## Behavior\n\n### Real-Time Filtering\n- Any interaction triggers immediate refresh\n- Results grid updates instantly\n- Available filter options update (hide zero-result paths)\n- Bidirectional updates: filters ↔ results\n\n### Filter Selection\n- Click filter item to select/deselect\n- Click X icon on selected item to deselect\n- Multiple selections across categories allowed\n\n### Clear All\n- Resets all selected filters across all columns\n- Shows all available filter options again\n- Updates content grid to show all items\n\n### Dynamic Filter Availability\n- As selections are made, incompatible options disappear\n- Only shows filters that will return results\n- Prevents \"no results\" scenarios\n\n## Technical Notes\n- Fixed position or sticky header behavior\n- No accordion (all columns always visible)\n- Horizontal scrolling on smaller desktop screens if needed\n- Columns auto-adjust width based on content\n",
      "# Filter System Architecture Reference\n\n## System Context\nA real-time filtering system for project portfolio browsing with mobile and desktop variants.\n\n## State Management\n\n### Filter State\n- **selectedFilters**: Map of category to selected filter IDs\n  - Example: `{ expertises: ['brand-exp', 'campaign'], creativeLenses: ['ai-data'] }`\n- **availableFilters**: Dynamic list of filters that will return results\n- **filterCounts**: Number of matching projects per filter option\n- **isLoading**: Boolean indicating filter update in progress\n\n### Project Grid State\n- **filteredProjects**: Array of projects matching current filter selection\n- **totalCount**: Total number of matching projects\n- **displayProjects**: Paginated subset currently visible\n\n### UI State (Mobile)\n- **isSheetOpen**: Bottom sheet visibility\n- **expandedGroups**: Array of group IDs currently expanded in accordion\n- **scrollPosition**: Current scroll position within sheet\n\n## Events\n\n### User Interactions\n- **filter-selected**: Fired when user selects a filter option\n  - Payload: `{ category: string, filterId: string }`\n- **filter-deselected**: Fired when user deselects a filter\n  - Payload: `{ category: string, filterId: string }`\n- **filters-cleared**: Fired when \"Clear all\" is clicked\n- **group-toggled** (mobile): Fired when accordion group expanded/collapsed\n  - Payload: `{ groupId: string, isExpanded: boolean }`\n- **sheet-opened** (mobile): Fired when bottom sheet slides up\n- **sheet-closed** (mobile): Fired when bottom sheet dismissed\n\n### System Events\n- **filters-recalculated**: Fired after filter availability updated\n  - Payload: `{ availableFilters: FilterOption[], hiddenCount: number }`\n- **projects-filtered**: Fired after project list filtered\n  - Payload: `{ projects: Project[], totalCount: number }`\n- **zero-results-hidden**: Fired when filters with no results removed\n  - Payload: `{ hiddenFilters: string[] }`\n\n## API Contracts\n\n### Filter Query API\n- **Endpoint**: `GET /api/projects/filter`\n- **Query params**: `?expertises[]=id1&expertises[]=id2&creativeLenses[]=id3`\n- **Response**:\n  ```json\n  {\n    \"projects\": [...],\n    \"totalCount\": 42,\n    \"availableFilters\": {\n      \"expertises\": [\n        { \"id\": \"brand-exp\", \"label\": \"Brand & Experience Strategy\", \"count\": 15 }\n      ],\n      \"creativeLenses\": [...]\n    }\n  }\n  ```\n\n### Filter Options API\n- **Endpoint**: `GET /api/filters/options`\n- **Response**: All available filter categories and options\n  ```json\n  {\n    \"expertises\": [...],\n    \"creativeLenses\": [...]\n  }\n  ```\n\n## Components\n\n### Organisms\n- **FilterSheet** (Mobile): Bottom sheet container with accordion\n- **FilterBar** (Desktop): Horizontal filter column layout\n\n### Molecules\n- **FilterGroup**: Category header + list of FilterItems + divider\n- **FilterItem**: Single selectable filter with active/inactive states\n\n### Atoms\n- **SpinnerLoading**: Loading indicator during filter updates\n\n## Data Flow\n\n1. **User selects filter** → `filter-selected` event\n2. **Update selectedFilters** in state\n3. **Fetch filtered projects** via Filter Query API\n4. **Receive response** with projects + updated availableFilters\n5. **Update UI**:\n   - Re-render project grid\n   - Hide zero-result filters\n   - Show loading spinner during fetch\n6. **Fire `projects-filtered`** event for analytics\n\n## Product Vocabulary\n\n### Categories\n- **Expertises**: Professional skill domains\n- **Creative Lenses**: Thematic perspectives or approaches\n\n### Filter Terms\n- Brand & Experience Strategy\n- Campaign & content design\n- Digital Product & Platforms\n- AI & Data & Innovation\n- Architectural Design\n- Non-Profit\n- Out-of-the-Box Thinking\n- Social Impact\n- Storytelling\n\n### Actions\n- **Select filter**: Add filter to active selection\n- **Deselect filter**: Remove filter from active selection\n- **Clear all**: Remove all active filters\n- **Expand/Collapse group**: Toggle accordion state (mobile)\n\n## Performance Notes\n- Real-time updates should complete within 300ms\n- Debounce rapid filter changes (200ms)\n- Optimistic UI updates before API response\n- Cache filter availability calculations\n\n## Security Notes\n- Validate filter IDs against whitelist\n- Sanitize query parameters\n- Rate limit filter API requests\n"
    ]
  },
  "consistencyReport": {
    "issues": [
      {
        "description": "story-2 lists story-1 as prerequisite, but story-1 doesn't list story-2 as dependent",
        "suggestedFixType": "missing-bidirectional-link",
        "confidence": 1,
        "affectedStories": [
          "story-1",
          "story-2"
        ]
      }
    ],
    "fixes": [
      {
        "type": "add-bidirectional-link",
        "storyId": "story-1",
        "path": "outcomeAcceptanceCriteria",
        "operation": "add",
        "item": {
          "id": "AC-OUT-DEP-1",
          "text": "Enables story-2 (dependent story)."
        },
        "confidence": 1,
        "reasoning": "story-2 lists story-1 as prerequisite; add reverse dependent link to story-1."
      }
    ]
  },
  "acceptanceCriteria": [
    {
      "name": ">80% stories ≥ 4.0",
      "value": 50,
      "threshold": 80,
      "pass": false
    },
    {
      "name": "<5% manual review",
      "value": 50,
      "threshold": 5,
      "pass": false
    }
  ]
}