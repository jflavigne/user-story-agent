# Port Number Detection Rule
# Finds numeric literals that look like network ports (1024-65535)
# High-value extraction targets for network configuration
#
# Usage with ast-grep MCP:
#   mcp__ast-grep__find_code_by_rule:
#     project_folder: /path/to/project
#     yaml: <contents of this file>

id: port-numbers
language: python
message: "Potential port number: $PORT"
severity: warning
rule:
  kind: integer
  pattern: $PORT
  # Common port number patterns
  regex: "^(80|443|808[0-9]|876[0-9]|[1-9][0-9]{3,4})$"
constraints:
  PORT:
    # 1024-65535 range (user ports)
    regex: "^([1-9][0-9]{3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$"
