# Environment Variable Default Detection Rule
# Finds os.getenv() and os.environ.get() calls with default values
# These defaults should be named constants
#
# Usage with ast-grep MCP:
#   mcp__ast-grep__find_code_by_rule:
#     project_folder: /path/to/project
#     yaml: <contents of this file>

id: env-defaults
language: python
message: "Environment variable with default - consider naming the default"
severity: hint
rule:
  any:
    # os.getenv("VAR", default)
    - pattern: os.getenv($VAR, $DEFAULT)
    # os.environ.get("VAR", default)
    - pattern: os.environ.get($VAR, $DEFAULT)
    # os.environ["VAR"] (no default - will raise if missing)
    - pattern: os.environ[$VAR]
