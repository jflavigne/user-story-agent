# Timeout Value Detection Rule
# Finds float/int literals in timeout-related contexts
# These are configuration values that should be named constants
#
# Usage with ast-grep MCP:
#   mcp__ast-grep__find_code_by_rule:
#     project_folder: /path/to/project
#     yaml: <contents of this file>

id: timeout-values
language: python
message: "Timeout/duration value - consider naming constant with _S or _MS suffix"
severity: warning
rule:
  any:
    # timeout=5.0, timeout=30
    - kind: keyword_argument
      all:
        - has:
            kind: identifier
            regex: "(timeout|delay|interval|duration|wait|sleep|ttl|expire)"
            stopBy: end
        - has:
            any:
              - kind: float
              - kind: integer
            stopBy: end
    # time.sleep(5.0)
    - pattern: time.sleep($DURATION)
    # asyncio.sleep(5.0)
    - pattern: asyncio.sleep($DURATION)
    # await asyncio.wait_for(..., timeout=5.0)
    - pattern: asyncio.wait_for($AWAITABLE, timeout=$TIMEOUT)
    # socket.settimeout(5.0)
    - pattern: $SOCKET.settimeout($TIMEOUT)
